description: The DRP pipeline specialized for Subaru's HyperSuprime-Cam
instrument: lsst.obs.subaru.HyperSuprimeCam
imports:
  - location: $DRP_PIPE_DIR/pipelines/_ingredients/DRP-full.yaml
    exclude:
      - consolidateSsTables
  - $ANALYSIS_TOOLS_DIR/pipelines/coaddColumnValidate.yaml
  - $ANALYSIS_TOOLS_DIR/pipelines/coaddQualityCore.yaml
  - $ANALYSIS_TOOLS_DIR/pipelines/exposureQualityCore.yaml
  - $ANALYSIS_TOOLS_DIR/pipelines/matchedVisitQualityCore.yaml
  - $ANALYSIS_TOOLS_DIR/pipelines/visitQualityCore.yaml
  - $ANALYSIS_TOOLS_DIR/pipelines/wholeSkyCore.yaml
parameters:
  extinctionCoeffs:
    g: 3.240
    r: 2.276
    i: 1.633
    z: 1.263
    y: 1.075
    N387: 4.007
    N395: 3.929
    N515: 2.939
    N816: 1.458
    N921: 1.187
tasks:
  isr:
    class: lsst.ip.isr.IsrTask
    config:
      doAmpOffset: true
      ampOffset.doApplyAmpOffset: true
  fgcmFitCycle:
    class: lsst.fgcmcal.fgcmFitCycle.FgcmFitCycleTask
    config:
      doMultipleCycles: true
  forcedPhotObjectDetector:
    class: lsst.pipe.tasks.forcedPhotDetector.ForcedPhotDetectorTask
    config:
      doDirectPhotometry: true
      doDifferencePhotometry: false
  analyzeObjectTableCore:
    class: lsst.analysis.tools.tasks.ObjectTableTractAnalysisTask
    config:
      # atools not in config yet when obs_lsst overrides objectTableTractAnalysis
      atools.wPerpPSF.process.buildActions.x.extinctionCoeffs: parameters.extinctionCoeffs
      atools.wPerpPSF.process.buildActions.y.extinctionCoeffs: parameters.extinctionCoeffs
      atools.xPerpPSF.process.buildActions.x.extinctionCoeffs: parameters.extinctionCoeffs
      atools.xPerpPSF.process.buildActions.y.extinctionCoeffs: parameters.extinctionCoeffs
      atools.yPerpPSF.process.buildActions.x.extinctionCoeffs: parameters.extinctionCoeffs
      atools.yPerpPSF.process.buildActions.y.extinctionCoeffs: parameters.extinctionCoeffs
      atools.wPerpCModel.process.buildActions.x.extinctionCoeffs: parameters.extinctionCoeffs
      atools.wPerpCModel.process.buildActions.y.extinctionCoeffs: parameters.extinctionCoeffs
      atools.xPerpCModel.process.buildActions.x.extinctionCoeffs: parameters.extinctionCoeffs
      atools.xPerpCModel.process.buildActions.y.extinctionCoeffs: parameters.extinctionCoeffs
      atools.yPerpCModel.process.buildActions.x.extinctionCoeffs: parameters.extinctionCoeffs
      atools.yPerpCModel.process.buildActions.y.extinctionCoeffs: parameters.extinctionCoeffs
